\documentclass[../main.tex]{subfiles}
\graphicspath{{figures/}{../figures/}}

\begin{document}
% % \todo[color=green!30]{完成问题一模型的建立(sections/q1\_build)}
\noindent \textbf{Step 1 在\( t \)时刻下导弹\( M_1 \)与真目标所在圆柱侧面各点的连线方程}
\par 随着烟幕干扰技术的不断发展，在导弹来袭过程中会通过投放烟幕干扰弹尽量避免来袭导弹发现真目标。控制中心在警戒雷达发现目标时，立即向无人机指派任务。令无人机 \( M1 \) 受领任务后开始沿相关轨迹进行运动的时间为 \( t \)，对于 \( t \) 时刻下导弹 \( M1 \)与真目标所在圆柱侧面各点的连线方程，由导弹$M1$在 \( t \) 时刻的位置坐标与真目标所在圆柱侧面各点确定。
\\
\textbf{(1) 导弹$M1$在\( t \)时刻的位置坐标}
\par 本题以假目标为原点$O$，水平面为$XY$平面建立直角坐标系$XYZ$.在该坐标系下记警戒雷达发现来袭导弹时，导弹$M1$的位置坐标为\( M{1,0}(x_{M{1,0}}, y_{M{1,0}}, z_{M{1,0}}) \).
\par 在警戒雷达发现来袭导弹后，导弹\( M1 \)以飞行速度\( v_0 \)匀速飞向一个为掩护真目标而设置的假目标。其中，导弹$M1$飞行速度\( v_0 \)已知，为$300m/s$。记 \( t \) 时刻下导弹 \( M1 \) 的位置坐标为 \( M1,t(x_{M1,t}, y_{M1,t}, z_{M1,t}) \)。由于已经确定导弹 \( M1 \) 的初始位置、运动方向与运行速度，根据直角坐标系下直线的标准方程，导弹在$t$时刻下的轨迹方程可表示为
\begin{align}\label{1.1}
\frac{x_{M1,0}-x_{M1t}}{x_{M1,0}}=\frac{y_{M1,0}-y_{M1,t}}{x_{M1,0}}=\frac{z_{M1,0}-z_{M1,t}}{z_{M1,0}}
\end{align}
\par 其参数方程为：
\begin{align}\label{1.2}
\left\{ \begin{array}{l}
x_{M1t}=x_{M1,0}-ax_{M1,0}\\
y_{M1t}=y_{M1,0}-ay_{M1,0}\\
z_{M1t}=z_{M1,0}-az_{M1,0}\\
\end{array} \right. ,a\in \left[ 0,+\infty \right)
\end{align}
\par 导弹$M1$从初始时刻到 \( t \) 时刻向假目标进行匀速直线运动，根据匀速直线运动的位移时间公式，其在 $t$ 时刻位置与初始时刻位置之间的距离$S_1$满足
\begin{align}\label{1.5}
S_1 = v_0 t
\end{align}
\par 同时，根据两点间距离公式，可以得到
\begin{align}\label{1.3}
S_1 =  \sqrt{(x_{M1,t} - x_{M1,0})^2 + (y_{M1,t} - y_{M1,0})^2 + (z_{M1,t} - z_{M1,0})^2}
\end{align}
\par 联立\eqref{1.2} \eqref{1.5} \eqref{1.3}，进而得到导弹 \( M1(t)(x_{M,t}, y_{M1,t}, z_{M1,t}) \) 在$t$时刻下的位置坐标
\begin{align}\label{1.4}
\left\{ \begin{array}{l}
x_{M1,t}=x_{M1,0}-\frac{x_{M1,0}v_0t}{\sqrt{x_{M1,0}^{2}+y_{M1,0}^{2}+z_{M1,0}^{2}}}\\
y_{M1,t}=y_{M1,0}-\frac{y_{M1,0}v_0t}{\sqrt{x_{M1,0}^{2}+y_{M1,0}^{2}+z_{M1,0}^{2}}}\\
z_{M1,t}=z_{M1,0}-\frac{z_{M1,0}v_0t}{\sqrt{x_{M1,0}^{2}+y_{M1,0}^{2}+z_{M1,0}^{2}}}\\
\end{array} \right. 
\end{align}


\noindent\textbf{(2)真目标所在圆柱侧面各点的位置坐标}
\par 由于导弹 \( M1 \) 与真目标所在圆柱的上底面和下底面上各点的连线，一定与圆柱侧面相交。故而，当我们考虑导弹 \( M1 \) 与圆柱上任一点的连线方程时，只需要考虑其与圆柱侧面上任一点的连线方程。因此，我们需要确定真目标所在圆柱侧面各点的位置坐$N_1\left( x_l,y_l,z_s \right) $。
\par 在直角坐标系中，真目标是半径为$r_0$、高为$h_0$的圆柱体，其下底面的圆心坐标为$\left( 0,y_0 \right)$。因此，真目标圆柱侧面上任一点位置坐标$N_1\left( x_l,y_l,z_s \right) $满足：
\begin{align}\label{1.6}
\varGamma _0:\begin{cases}
{x_l}^2+\left( y_l-y_0 \right) ^2=r_{0}^{2}\\
z_s\in \left[ 0,h_0 \right]\\
\end{cases}
\end{align}
\par 其中，$y_0=200,r_0=7,h_0=10$.




\noindent\textbf{(3) 在\( t \)时刻下导弹\( M1 \)与真目标所在圆柱侧面各点的连线方程}
\par 通过\eqref{1.4}\eqref{1.6}，我们得到了导弹$M1$在\( t \)时刻的位置坐标\( M1,t(x_{M1,t}, y_{M1,t}, z_{M1,t}) \)以及真目标所在圆柱侧面任一点位置坐标$N_1\left( x_1,y_1,z_1 \right) $.因此，确定了$N_1,M1,t$所在的直线方程
\begin{align}\label{1.7}
\frac{x-x_1}{x_{M1,t}-x_1}=\frac{y-y_1}{y_{M1,t}-y_1}=\frac{z-z_1}{z_{M1,t}-z_1}=k 
\end{align}
\par 其中，$k$为参数。


\noindent\textbf{Step 2 烟幕干扰弹起爆后形成的云团球体在$t$时刻的球面方程}
\par 烟幕干扰弹经无人机投放，并且脱离无人机后在重力作用下运动一段时间后起爆形成球状烟幕云团，云团半径已知，该烟幕云团以速度$v_1$匀速下沉.因此，云团球体在$t$时刻的球面方程由云团球体中心确定，也就是由烟幕干扰弹起爆时的位置确定，再进一步，我们需要知晓烟幕干扰弹投放时的位置坐标。
\\
\noindent \textbf{(1) 烟幕干扰弹投放时的位置坐标}
\par 通过题目给定条件可知,在警戒雷达发现来袭导弹后，无人机\( FY1 \)以飞行速度\( v_{FY1} \)匀速等高朝向假目标方向飞行,并在受领任务$t_1$秒后投放1枚烟幕干扰弹在来袭武器和保护目标之间形成烟幕遮蔽。
因此无人机$FY1$在$t_1$时刻的位置坐标即烟幕干扰弹投放时的位置坐标$(x_{FY1,t_1}, y_{FY1,{t_1}}, z_{FY1,{t_1}})$满足
\begin{align}\label{1.8}
\left\{ \begin{array}{l}
x_{FY1,{t_1}}=x_{FY1,0}-v_{FY1}{t_1}\\
y_{FY1,{t_1}}=y_{FY1,0}\\
z_{FY1,{t_1}}=z_{FY1,0}\\
\end{array} \right. 
\end{align}
\par 其中，无人机$FY1$飞行速度\( v_{FY1} \)已知为$120m/s$，$t_1$已知为1.5$s$。


\noindent\textbf{(2) 烟幕干扰弹起爆时的位置坐标}
\par 烟幕干扰弹脱离无人机后，在重力作用下进行匀加速运动。并在$t_2$秒起爆分散形成烟幕或气溶胶云团,进而在目标前方特定空域形成遮蔽，干扰敌方导弹$M1$.此时，烟幕干扰弹水平方向飞行速度即无人机飞行速度\( v_{FY1} \)，烟幕干扰弹竖直方向加速度即重力加速度$g$,因此烟幕干扰弹起爆时的位置坐标$\left( x_{FY11,t_2},y_{FY11,t_2},z_{FY11,t_2} \right)$满足
\begin{align}\label{1.9}
\left\{ \begin{array}{l}
	x_{FY11,{t_2}}=x_{FY1,t_1}-v_{FY1}\text{（}t_2-t_1\text{）}\\
	y_{FY11,{t_2}}=y_{FY1,t_1}\\
	z_{FY11,{t_2}}=z_{FY1,t_1}-\frac{g\text{（}t_2-t_1\text{）}^2}{2}\\
\end{array} \right. 
\end{align}
\par 其中，烟幕干扰弹水平方向飞行速度即\( v_{FY1} \)已知为$120m/s$,烟幕干扰弹起爆时间$t_2$已知，为5.1$s$。


\noindent \textbf{(3)云团球体在$t$时刻的球面方程 }
\par 烟幕干扰弹起爆后瞬时形成球状烟幕云团，由于采用特定技术，该烟幕云团以速度$v_1$匀速下沉。云团中心$rm$范围内的烟幕浓度在起爆后一定时间内可为目标提供有效遮蔽。
已知烟幕干扰弹起爆后瞬时形成的球状云团中心位置即烟幕干扰弹起爆时的位置坐标$\left( x_{FY11,t_2},y_{FY11,t_2},z_{FY11,t_2} \right)$，并且球状烟幕云团以速度$v_1$匀速下沉.因此,球状烟幕云团球体中心在$t$时刻的位置坐标$(x_{FY1,t}, y_{FY1,{t}}, z_{FY1,{t}})$满足
\begin{align}\label{1.10}
\left\{ \begin{array}{l}
	x_{FY11,t}=x_{FY11,t_2}\\
	y_{FY11,t}=y_{FY11,t_2}\\
	z_{FY11,t}=z_{FY11,t_2}-v_1\left( t-t_2 \right)\\
\end{array} \right. 
\end{align}
\par 其中，烟幕云团匀速下沉的速度$v_1$已知,为$3m/s$。因此可以得到云团球体在$t$时刻的球面方程：
\begin{align}\label{1.11}
O_{FY11,t}:\left( x-x_{FY11,t} \right) ^2+\left( y-y_{FY11,t} \right) ^2+\left( z-z_{FY11,t} \right) ^2=r^2\left( 1.5 \right) 
\end{align}
\par 其中，云团球体的半径$r$为$10m$.
\\
\textbf{Step 3 判断$t$时刻烟幕云团是否有效遮蔽真目标}
\par 通过\eqref{1.7}\eqref{1.11}，我们得到了在\( t \)时刻下导弹\( M1 \)与真目标所在圆柱侧面各点的连线方程以及烟幕干扰弹起爆后形成的云团球体的球面方程。当导弹\( M1 \)与真目标所在圆柱侧面各点的连线方程与烟幕云团球面方程在$t$时刻下相交，则烟幕云团有可能遮挡真目标；反之，则烟幕云团不可能遮挡真目标。则在相交情况下，直线方程与烟幕云团球体表面的交点到真目标所在圆柱侧面上的点的距离如果都小于或等于此时导弹$M1$到圆柱侧面上的点的距离，则在此时刻下形成有效遮挡；否则，在此时刻下未形成有效遮挡。
\par 联立\eqref{1.6}\eqref{1.7}\eqref{1.11},得到了$t$时刻下导弹\( M1 \)与真目标所在圆柱侧面各点的连线与云团球体的球面是否相交的判别式：
\begin{small}
\begin{align}\label{1.12}
	\begin{split}
\Delta(x_l, y_l, z_s) &= 4\left[(x_{M1,t} - x_1)(x_1 - x_{FY11,t}) + (y_{M1,t} - y_1)(y_1 - y_{FY11,t}) + (z_{M1,t} - z_1)(z_1 - z_{FY11,t})\right]^2 \\
&\quad - 4\left[(x_{M1,t} - x_1)^2 + (y_{M1,t} - y_1)^2 + (z_{M1,t} - z_1)^2\right] \\
&\quad\quad\times\left[(x_1 - x_{FY11,t})^2 + (y_1 - y_{FY11,t})^2 + (z_1 - z_{FY11,t})^2 - r^2\right]
\end{split}	
\end{align}	
\end{small}
\par 在$t$时刻下，只有当导弹$M1$与真目标所在圆柱所有点的连线方程与云团球体的球面相交，才有可能进行遮挡。
\par 导弹$M1$以速度$v_0$匀速飞行至假目标，本文假设当导弹到达假目标时，发现其为假目标。已知导弹$M1$的初始位置\( M{1,0}(x_{M{1,0}}, y_{M{1,0}}, z_{M{1,0}}) \)和假目标所在位置即原点，因此可以得到时间$t$的范围
\begin{align}\label{1.190}
\begin{cases}
d_{m1,0} = \sqrt{(x_{m1,0})^2 + (z_{m1,0})^2} \\
0 \leq t \leq \frac{d_{m1,0}}{v_0}
\end{cases}
\end{align}
\par 将时间$t$进行离散化处理，从而方便计算。将时间$t$按步长$\varDelta r$划分，得到$J$个离散点，因此
\begin{align}\label{1.191}
	\frac{d_{m1,0}}{v_0}=J.\varDelta r
\end{align}

\par 其中第$w$个离散点记为$t_w$,计算公式如下
\begin{align}\label{1.52}
	t_w=\frac{t}{J}.w\,\,\,\,\left( w=1,...,J\right) 
\end{align}








\par 为方便计算，我们将真目标所在圆柱体侧面进行离散化处理。通过题目给定条件，可以得知真目标是半径为$r_0$、高为$h_0$的圆柱体，其下底面的圆心坐标为$\left( 0,y_0 \right)$。我们将真目标所在圆柱体的底面圆周作$n_1$等分，每一部分的圆心角$\varDelta \varphi =2\pi /n_1$。接着将圆柱的高度$h_0$沿$z$轴进行$n_2$等分，每段的高度$\varDelta h=h_0/n_2$.因此我们可以将真目标所在圆柱体侧面离散成$n_1\times n_2$个离散点。记第$l$份圆心角为$\varphi _l$,计算公式如下：
\begin{align}\label{1.13}
	\varphi _l=\frac{\varphi}{n_1}.l\ \ \left( l=1,...,n_1 \right) 
\end{align}
\par 记圆柱体的第$s$份高度为$h_s$,计算公式如下：
\begin{align}\label{1.14}
	h_s=\frac{h_0}{n_2}.s\,\,\,\,\left( s=1,...,n_2 \right) 
\end{align}
\par 圆柱体侧面上的点位置坐标$N_1\left( x_l,y_l,z_s \right) $可表示为
\begin{align}
	\begin{cases}\label{1.15}
x_l = r_0 \cos\left( \frac{2\pi}{n_1} \cdot l \right) \\
y_l = y_0 + r_0 \sin\left( \frac{2\pi}{n_1} \cdot l \right) \\
z_s = \frac{h_0}{n_2} \cdot s
\end{cases}
\end{align}	
\par 其中 \( l = 1, \dots, n_1 \)，\( s = 1, \dots, n_2 \)。
\par 将所有点位置坐标代入判别式中，即遍历$l$,$s$，可以得知在$t_w$时刻下导弹$M1$与真目标所在圆柱所有点的连线方程与云团球体的球面是否相交。但是通过此判断式不能确定烟幕云团是否有效遮挡真目标，因此我们还需要加入其他条件。当$\Delta \left( x_l,y_l,z_s \right) \ge 0$时有交点，交点参数表达式如下
\begin{align}\label{1.16}
k_1 = \frac{-b + \sqrt{\Delta}}{2a}, \quad k_2 = \frac{-b - \sqrt{\Delta}}{2a}
\end{align}
\par 因此导弹$M1$与真目标所在圆柱所有点的连线方程与云团球体的球面交点到圆柱侧面上的点的距离计算公式为
\begin{align}\label{1.17}
	\begin{aligned}
d_1 &= \sqrt{k_1^2(x_{M1,t} - x_1)^2 + k_1^2(y_{M1,t} - y_1)^2 + k_1^2(z_{M1,t} - z_1)^2}, \\
d_2 &= \sqrt{k_2^2(x_{M1,t} - x_1)^2 + k_2^2(y_{M1,t} - y_1)^2 + k_2^2(z_{M1,t} - z_1)^2},
\end{aligned}
\end{align}
\par 其中导弹 \( M1 \) 到圆柱侧面上的点的的距离：
\begin{align}\label{1.18}
	\left| \overrightarrow{N1M1} \right|=\sqrt{\left( x_{M1,t}-x_{n1} \right) ^2+\left( y_{M1,t}-y_{n1} \right) ^2+\left( y_{M1,t}-y_{n2} \right) ^2}
\end{align}
\par 只有在$t$时刻下，对于真目标所在圆柱侧面的所有离散点 \( (x_1, y_1, z_1) \)均满足 \( \Delta \geq 0 \)，且导弹$M_1$与真目标所在圆柱所有点的连线方程与云团球体的球面交点到原点的距离 \( d_1, d_2 \) 中至少有一个比导弹到原点的距离更近（即 \( d_1 \leq \left| \overrightarrow{N1M1} \right| \) 或 \( d_2 \leq \left| \overrightarrow{N1M1} \right| \)）时，才能形成有效遮挡；否则，未形成有效遮挡。即：
\begin{align}\label{1.19}
	\left\{ \begin{array}{l}
	\varDelta <0\ \ \ \text{未形成有效遮挡}\\
	\varDelta \ge 0\left\{ \begin{array}{l}
	\min \left\{ d_1,d_2 \right\} >\left| \overrightarrow{N1M1} \right|\ \ \ \ \ \ \ \ \text{未形成有效遮挡}\\
	\min \left\{ d_1,d_2 \right\} \le \left| \overrightarrow{N1M1} \right|\ \ \ \ \ \ \ \ \text{有效遮挡}\\
\end{array} \right.\\
\end{array} \right. 
\end{align}
\textbf{Step 4 烟幕干扰弹对导弹$M1$的有效遮挡时长计算}
\par 综上所述，烟幕干扰弹对导弹$M1$的有效遮挡时长计算步骤如下.
\\
\textbf{步骤1:}固定时间$t_w$,通过遍历$l$,$s$,得到$t_w$时刻下导弹$M1$与真目标所在圆柱所有点的连线方程，代入\eqref{1.12}中,得到判别式$\Delta \left( x_l,y_l,z_s \right)$。
\\
\textbf{步骤2:}如果判别式$\Delta \left( x_l,y_l,z_s \right)$满足\eqref{1.19}即
\begin{align}\label{1.19}
	\left\{ \begin{array}{l}
	\varDelta <0\ \ \ \text{未形成有效遮挡}\\
	\varDelta \ge 0\left\{ \begin{array}{l}
	\min \left\{ d_1,d_2 \right\} >\left| \overrightarrow{N1M1} \right|\ \ \ \ \ \ \ \ \text{未形成有效遮挡}\\
	\min \left\{ d_1,d_2 \right\} \le \left| \overrightarrow{N1M1} \right|\ \ \ \ \ \ \ \ \text{有效遮挡}\\
\end{array} \right.\\
\end{array} \right. 
\end{align}
\par 则可以判断$t_w$时刻下，烟幕云团是否有效遮蔽真目标。
\\
\textbf{步骤3:}遍历$w$,可以得知不同时间点烟幕云团是否有效遮蔽真目标。遮挡真目标，则进行下一步骤。反之，舍弃。
\\
\textbf{步骤4:}烟幕干扰弹对导弹$M1$的遮挡的时间点是连续的，所以将步骤3中得到的时间点的最大值减去最小值即可得到烟幕干扰弹对导弹$M1$的有效遮挡时长,即
\begin{align}\label{1.189}
	\varDelta t_1=\max t_w-\min t_w
\end{align}




\end{document}