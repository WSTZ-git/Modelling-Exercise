\documentclass[../main.tex]{subfiles}
\graphicspath{{figures/}{../figures/}}

\begin{document}
% \todo[color=green!40]{完成问题三模型的求解(sections/q3\_solution)}

我们利用模拟退火算法求解上述单目标优化模型。
使用模拟退火算法求解“有效遮蔽时间单目标优化模型”的核心思路是：通过模拟物理退火过程的随机搜索与概率接受机制，在决策变量的可行域内寻找使有效遮蔽时间$\Delta t$最大化的最优解。具体步骤如下：

\noindent\textbf{步骤1 初始化参数}
\begin{itemize}
    \item 初始解：在可行域内随机生成$S_0=(\alpha_0, v_{\text{FY1},0})$，其中$\alpha_0 \in [0,2\pi]$，$v_{\text{FY1},0} \in [70,140]$；
    \item 算法参数：初始温度$T_0=100$，降温系数$k=0.95$，终止温度$T_{\text{end}}=10^{-5}$，每轮迭代次数$L=50$。
\end{itemize}

\noindent\textbf{步骤2 目标函数$\Delta t$计算（核心）}

对任意解$S=(\alpha, v_{\text{FY1}})$，按以下流程计算$\Delta t$：
\begin{itemize}
    \item 依据“无人机位置公式”，计算烟幕投放时刻$t_{\text{FYj,11}}$的无人机坐标；
    \item 依据“烟幕弹起爆位置公式”（含重力下落项），计算起爆时刻$t_{\text{FYj,12}}$的位置；
    \item 依据“烟幕云团运动公式”，计算$t \in [t_{\text{FYj,12}}, t_{\text{FYj,12}}+\Delta t_0]$内的云团中心，结合球面方程确定有效区域；
    \item 在真目标圆柱面（$x_1^2+(y_1-y_0)^2=r_0^2, z_1 \in [0,h_0]$）上采样关键点位，通过$\sum_{j=1}^3 a_1^j$判定各时刻遮挡状态，累加有效时长得$\Delta t$。
\end{itemize}

\noindent\textbf{步骤3 邻域解生成}

对当前解$S=(\alpha, v_{\text{FY1}})$添加随机扰动：
\begin{itemize}
    \item 方向角：$\alpha' = \alpha \pm 0.1$（弧度），超出$[0,2\pi]$则取模调整；
    \item 速度：$v_{\text{FY1}}' = v_{\text{FY1}} \pm 5$（$\text{m/s}$），超出$[70,140]$则截断至边界。
\end{itemize}

\noindent\textbf{步骤4  Metropolis准则（接受新解）}

计算目标函数差值$\Delta E = \Delta t(S') - \Delta t(S)$：
\begin{itemize}
    \item 若$\Delta E > 0$：直接接受$S'$为当前解；
    \item 若$\Delta E \leq 0$：以概率$P = \exp(\Delta E/T)$接受$S'$（$T$为当前温度，温度越高接受概率越大）。
\end{itemize}

\noindent\textbf{步骤5 降温迭代与终止}

每完成$L$次迭代后，按$T = k \cdot T$降温；重复“邻域搜索→接受准则→降温”，直至$T \leq T_{\text{end}}$，输出最优解$S^*=(\alpha^*, v_{\text{FY1}}^*)$及最大$\Delta t^*$。






\end{document}